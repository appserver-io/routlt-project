<?xml version="1.0" encoding="UTF-8"?>
<project name="appserver-io/routlt-project">

    <!-- initialize ENV variable -->
    <property environment="env" />

    <!-- initialize the Rout.Lt specific properties -->
    <property name="appserver.webapps.dir" value="${basedir}/webapps" />
    <property name="routlt-project.basedir" value="${vendor.dir}/appserver-io/routlt-project" />

    <!-- ==================================================================== -->
    <!-- Creates a new Rout.Lt project                                        -->
    <!-- ==================================================================== -->
    <target name="routlt-create-project" description="Creates a new Rout.Lt project.">
        <!-- query the user for necessary project data -->
        <input addproperty="application.name" message="Application Name"/>
        <input addproperty="installation.dir" defaultvalue="${appserver.webapps.dir}/${application.name}" message="Installation Directory"/>
        <input addproperty="vendor.name" message="Vendor Name"/>
        <input addproperty="package.name" message="Package Name"/>
        <!-- prepare action and Rout.Lt action namespace -->
        <property name="package.namespace" value="\${vendor.name}\${package.name}"/>
        <property name="action.namespace" value="\${package.namespace}\Actions"/>
        <property name="routlt.action.namespace" value="/${vendor.name}/${package.name}/Actions"/>
        <!-- copy the static framework files -->
        <copy todir="${installation.dir}">
            <fileset dir="${routlt-project.basedir}/templates/static">
                <include name="**/*"/>
            </fileset>
            <filterchain>
                <expandproperties/>
            </filterchain>
        </copy>
        <!-- copy the dynamic framework files -->
        <copy todir="${installation.dir}/WEB-INF/classes/${package.namespace}">
            <fileset dir="${routlt-project.basedir}/templates/dynamic/WEB-INF">
                <include name="**/*"/>
            </fileset>
            <filterchain>
                <expandproperties/>
            </filterchain>
        </copy>
        <!-- install composer dependencies -->
        <exec dir="${installation.dir}" executable="composer">
            <arg line="--no-interaction install"/>
        </exec>
        <!-- create the default catch-all index.do file -->
        <touch file="${installation.dir}/index.do"/>
    </target>

</project>